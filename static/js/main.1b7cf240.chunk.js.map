{"version":3,"sources":["header.png","config.js","App.js","index.js"],"names":["module","exports","__webpack_require__","p","config","api","charAt","length","App","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","updateSonge","state","current","latest","split","map","s","Number","selectFile","e","preventDefault","fileInput","click","submitFile","file","formData","FormData","append","options","method","body","setState","converting","window","fetch","concat","then","res","json","error","open","url","undefined","catch","handleFIChange","target","files","size","type","name","React","createRef","react_default","a","createElement","Container_default","className","id","Collapse_default","in","Alert_default","variant","Card_default","Img","src","header","Body","Text","Row_default","Col_default","Button_default","onClick","block","disabled","Fragment","Spinner_default","as","animation","role","ListGroup_default","Item","href","openLinks","accept","ref","onChange","Component","ReactDOM","render","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.1b7cf240.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/header.9264d15f.png\";","export default {\r\n  api: 'https://scw.raphaeltheriault.com/'\r\n}\r\n","/* global FormData */\n\nimport React from 'react'\nimport Alert from 'react-bootstrap/Alert'\nimport Button from 'react-bootstrap/Button'\nimport Card from 'react-bootstrap/Card'\nimport Col from 'react-bootstrap/Col'\nimport Collapse from 'react-bootstrap/Collapse'\nimport Container from 'react-bootstrap/Container'\nimport ListGroup from 'react-bootstrap/ListGroup'\nimport Row from 'react-bootstrap/Row'\nimport Spinner from 'react-bootstrap/Spinner'\nimport 'whatwg-fetch'\nimport './bootstrap.min.css'\nimport config from './config'\nimport header from './header.png'\n\nif (config.api.charAt(config.api.length - 1) !== '/') config.api += '/'\n\nclass App extends React.Component {\n  constructor (props) {\n    super(props)\n    this.state = {\n      file: false,\n      error: false,\n      converting: false,\n      current: 'Loading...',\n      latest: 'Loading...'\n    }\n    this.fileInput = React.createRef()\n    this.file = undefined\n\n    window.fetch(config.api)\n      .then(res => res.json())\n      .then(json => {\n        const current = json.current\n        const latest = json.latest\n        this.setState({ current, latest })\n      })\n      .catch(() => this.setState({ error: 'The API doesn\\'t respond.' }))\n  }\n\n  static openLinks (e) {\n    e.preventDefault()\n    window.open('https://github.com/raftario/songe-converter-web', '_blank')\n    window.open('https://github.com/lolPants/songe-converter', '_blank')\n  }\n\n  updateSonge = () => {\n    if (this.state.current === 'Loading...' || this.state.latest === 'Loading...') return false\n\n    const current = this.state.current.split('.').map(s => Number(s))\n    const latest = this.state.latest.split('.').map(s => Number(s))\n\n    if (current[0] < latest[0]) return true\n    else if (current[1] < latest[1]) return true\n    else return current[2] < latest[2]\n  }\n\n  selectFile = e => {\n    e.preventDefault()\n    this.fileInput.current.click()\n  }\n\n  submitFile = e => {\n    e.preventDefault()\n\n    if (this.file) {\n      const formData = new FormData()\n      formData.append('zip', this.file)\n      const options = {\n        method: 'POST',\n        body: formData\n      }\n\n      this.setState({ converting: true })\n\n      window.fetch(`${config.api}upload`, options)\n        .then(res => res.json())\n        .then(json => {\n          if (!json.error) window.open(`${config.api}${json.url}`, '_blank')\n          this.setState({\n            file: false,\n            error: json.error,\n            converting: false\n          })\n          this.file = undefined\n        })\n        .catch(() =>\n          this.setState({ converting: false, error: 'An error occured while trying to upload the file.' })\n        )\n    } else this.setState({ error: 'A file needs to be selected.' })\n  }\n\n  handleFIChange = e => {\n    const file = e.target.files[0]\n\n    if (!file) {\n      this.file = undefined\n      this.setState({ file: false, error: false })\n    } else {\n      if (file.size > 2 * 1024 * 1024) {\n        this.file = undefined\n        this.setState({ file: false, error: 'The selected file is too large (max size is 2MB).' })\n      } else if (file.type !== 'application/zip' && file.type !== 'application/x-zip-compressed') {\n        this.file = undefined\n        this.setState({ file: false, error: 'The selected file is not in a valid format.' })\n      } else {\n        this.file = file\n        this.setState({ file: file.name, error: false })\n      }\n    }\n  }\n\n  render () {\n    return (\n      <Container className='p-3' id='App'>\n        <Collapse in={!!this.state.error}>\n          <div>\n            <Alert variant='danger'>{this.state.error}</Alert>\n          </div>\n        </Collapse>\n        <Card>\n          <Card.Img variant='top' src={header} />\n          <Card.Body>\n            <Card.Text className='lead'>\n              Just select your song and hit Convert !\n            </Card.Text>\n            <Card.Text>\n              Your song must be compressed in a <code>.zip</code> file. You should remove the <code>song.ogg</code> file\n              and other unnecessary files from the <code>.zip</code> before uploading your song. You can put multiple\n              songs in the same file as long as it doesn't exceed the size limit (2MB).\n            </Card.Text>\n            <Row>\n              <Col>\n                <Button variant='outline-secondary' size='lg' onClick={this.selectFile} block>\n                  {this.state.file || 'Select file'}\n                </Button>\n              </Col>\n              <Col className='text-right'>\n                <Button variant='secondary' size='lg' disabled={!this.state.file} onClick={this.submitFile} block>\n                  {this.state.converting\n                    ? <>Converting <Spinner as='span' size='sm' animation='border' role='status' /></>\n                    : 'Convert'\n                  }\n                </Button>\n              </Col>\n            </Row>\n          </Card.Body>\n          <ListGroup variant='flush'>\n            <ListGroup.Item>\n              <Row>\n                <Col>\n                  Current version: <code>{this.state.current}</code>\n                </Col>\n                <Col className='text-center'>\n                  Latest version: <code>{this.state.latest}</code>\n                </Col>\n                <Col className='text-right'>\n                  <Button variant='outline-secondary' size='sm' disabled={!this.updateSonge()}>Update</Button>\n                </Col>\n              </Row>\n            </ListGroup.Item>\n            <ListGroup.Item>\n              <Row>\n                <Col>\n                  <small className='text-muted'>Songe Converter by lolPants</small>\n                </Col>\n                <Col className='text-center'>\n                  <small className='text-muted'>Web app by Raphaël Thériault</small>\n                </Col>\n                <Col className='text-right'>\n                  <small className='text-muted'><a href='#App' onClick={App.openLinks}>View on GitHub</a></small>\n                </Col>\n              </Row>\n            </ListGroup.Item>\n          </ListGroup>\n        </Card>\n        <input\n          className='d-none'\n          type='file' name='zip'\n          accept='application/zip'\n          ref={this.fileInput}\n          onChange={this.handleFIChange}\n        />\n      </Container>\n    )\n  }\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}